rule super_0 {
	meta:
		description = "super rule for memory"
		author = "Bulwarkz Yara Rule Generator 1.0.0"
		yaraversion = ">= 3.2.0"
		tag = "Bulwarkz"
		bulwarkzsandboxid = "235140, 235139, 235138"
		detection = "malicious"
		source = "memory dumps from processes: nuvanuj.exe, vklrr.exe, ussqtqgp.exe"
		ruletype = "memorycode"
		md5 = "053865EA51D8373E21B5F1E0946AB9D8, 053865EA51D8373E21B5F1E0946AB9D8, 053865EA51D8373E21B5F1E0946AB9D8"
		superrule = "yes"
		date = "19/03/2017"
	strings:
		// Relevance: 57.991  API Chain: GetCurrentProcessId,GetTickCount,GetModuleFileNameA,GetModuleFileNameA,GetCurrentProcess,LookupAccountSidA,GetModuleFileNameA,lstrlenA,lstrlenA,lstrlenA,lstrlenA,GetCurrentProcess,GetVersionExA,GetEnvironmentVariableA,GetEnvironmentVariableA,GetWindowsDirectoryA,SetEnvironmentVariableA,GetEnvironmentVariableA,SetEnvironmentVariableA,GetEnvironmentVariableA,SetEnvironmentVariableA,lstrlenA,
		$code0 = { 55 8B ?? 81 ?? ?? ?? ?? ?? 53 56 57 33 ?? 68 ?? ?? ?? ?? 57 68 ?? ?? ?? ?? 89 ?? ?? 89 ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? FF ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? A3 ?? ?? ?? ?? FF ?? ?? ?? ?? ?? 03 ?? ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? 8B ?? ?? ?? ?? ?? 59 59 68 ?? ?? ?? ?? BE ?? ?? ?? ?? 56 57 FF ?? 85 ?? 74 ?? 6A ?? 56 E8 ?? ?? ?? ?? 59 59 A3 ?? ?? ?? ?? FF ?? ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? A3 ?? ?? ?? ?? FF ?? E8 ?? ?? ?? ?? 59 59 85 ?? 74 ?? C7 ?? ?? ?? ?? ?? ?? ?? ?? ?? EB ?? E8 ?? ?? ?? ?? 33 ?? 85 ?? 0F 9F ?? 41 89 ?? ?? ?? ?? ?? 8B ?? ?? A3 ?? ?? ?? ?? B8 ?? ?? ?? ?? 89 ?? ?? 89 ?? ?? 8D ?? ?? 50 8D  }
		// Relevance: 31.7  API Chain: lstrlenA,CloseHandle,CoInitializeEx,GetForegroundWindow,ShellExecuteA,Sleep,CopyFileA,ReleaseMutex,CloseHandle,ReleaseMutex,CloseHandle,
		$code1 = { 55 8B ?? 81 ?? ?? ?? ?? ?? 53 56 33 ?? 68 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 53 50 88 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 ?? ?? E8 ?? ?? ?? ?? 8B ?? ?? 6A ?? 89 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? 85 ?? 0F 88 ?? ?? ?? ?? 53 53 56 E8 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 50 8D ?? ?? 50 FF ?? ?? E8 ?? ?? ?? ?? 8B ?? 83 ?? ?? 3B ?? 75 ?? 33 ?? 40 E9 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 50 FF ?? ?? ?? ?? ?? 85 ?? 74 ?? 53 53 53 68 ?? ?? ?? ?? 53 8D ?? ?? ?? ?? ?? 50 FF ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? ?? 7E ?? 8B ?? ?? EB ?? B8 ?? ?? ?? ?? 50 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 8D ?? ?? ??  }
		// Relevance: 26.353  API Chain: RegisterClassExA,CreateWindowExA,ShowWindow,UpdateWindow,TranslateMessage,DispatchMessageA,GetMessageA,DestroyWindow,UnregisterClassA,WaitForSingleObject,ReleaseMutex,CloseHandle,
		$code2 = { 55 8B ?? 83 ?? ?? 56 57 6A ?? 33 ?? 8D ?? ?? 57 50 E8 ?? ?? ?? ?? A1 ?? ?? ?? ?? 89 ?? ?? 83 ?? ?? 8D ?? ?? BE ?? ?? ?? ?? 50 89 ?? ?? 89 ?? ?? C7 ?? ?? ?? ?? ?? ?? 89 ?? ?? C7 ?? ?? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? 89 ?? ?? FF ?? ?? ?? ?? ?? ?? 85 ?? 74 ?? 57 FF ?? ?? ?? ?? ?? B8 ?? ?? ?? ?? 57 57 6A ?? 68 ?? ?? ?? ?? 50 50 68 ?? ?? ?? ?? 56 56 57 FF ?? ?? ?? ?? ?? A3 ?? ?? ?? ?? 3B ?? 74 ?? E8 ?? ?? ?? ?? 57 FF ?? ?? ?? ?? ?? FF ?? ?? ?? ?? ?? FF ?? ?? ?? ?? ?? FF ?? ?? ?? ?? ?? EB ?? 83 ?? ?? 74 ?? 8D ?? ?? 50 FF ?? ?? ?? ?? ?? 8D ?? ?? 50 FF ?? ?? ?? ?? ?? 57 57 57 8D ?? ?? 50 FF ?? ??  }
		// Relevance: 24.614  API Chain: RegOpenKeyExA,lstrlenA,RegQueryValueExA,lstrlenA,lstrlenA,RegCloseKey,lstrlenA,lstrlenA,GetComputerNameA,GetVolumeInformationA,lstrlenA,lstrlenA,lstrcatA,lstrlenA,
		$code3 = { 55 8B ?? 81 ?? ?? ?? ?? ?? 53 56 57 33 ?? BF ?? ?? ?? ?? 57 8D ?? ?? ?? ?? ?? 53 50 89 ?? ?? 89 ?? ?? 89 ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? 8D ?? ?? 50 68 ?? ?? ?? ?? 53 FF ?? ?? ?? ?? ?? 89 ?? ?? 68 ?? ?? ?? ?? FF ?? ?? ?? ?? ?? 8B ?? ?? ?? ?? ?? 3B ?? 75 ?? 8D ?? ?? 50 8D ?? ?? ?? ?? ?? 50 53 53 FF ?? ?? ?? ?? ?? FF ?? ?? FF ?? ?? ?? ?? ?? 3B ?? 74 ?? FF ?? ?? 8D ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? 50 FF ?? 8B ?? 2B ?? 51 8D ?? ?? ?? ?? ?? 50 FF ?? 8D ?? ?? ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? 83 ?? ?? FF ?? ?? FF ?? ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 50 FF ?? 8B ?? 2B ?? 8D ?? ?? 50 8D ?? ?? ?? ?? ?? 50 89 ??  }
		// Relevance: 17.617  API Chain: FindFirstFileA,FindClose,lstrcmpA,lstrcmpA,FindNextFileA,FindClose,RemoveDirectoryA,
		$code4 = { 55 8B ?? 81 ?? ?? ?? ?? ?? 53 56 57 6A ?? 68 ?? ?? ?? ?? BB ?? ?? ?? ?? 53 BF ?? ?? ?? ?? 57 8D ?? ?? ?? ?? ?? 50 BE ?? ?? ?? ?? 56 E8 ?? ?? ?? ?? 6A ?? 68 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 50 68 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 50 56 E8 ?? ?? ?? ?? 83 ?? ?? 8D ?? ?? ?? ?? ?? 50 8D ?? ?? ?? ?? ?? 50 FF ?? ?? ?? ?? ?? 89 ?? ?? 83 ?? ?? 75 ?? 50 FF ?? ?? ?? ?? ?? 6A ?? 58 E9 ?? ?? ?? ?? 68 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 6A ?? 50 C6 ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 68 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 6A ?? 50 C6 ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? 68 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 50 FF ?? ?? ?? ??  }
		// Relevance: 16.001  API Chain: CreateMutexA,GetLastError,GetLastError,CopyFileA,lstrcpyA,lstrcpyA,ReleaseMutex,CloseHandle,
		$code5 = { 55 8B ?? 6A ?? 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? ?? A1 ?? ?? ?? ?? 50 ?? 89 ?? ?? ?? ?? ?? 81 ?? ?? ?? ?? ?? 53 56 57 89 ?? ?? C7 ?? ?? ?? ?? ?? ?? ?? ?? ?? 68 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 50 8B ?? ?? 51 E8 ?? ?? ?? ?? 83 ?? ?? 85 ?? 75 ?? 33 ?? 74 ?? EB ?? 83 ?? ?? E9 ?? ?? ?? ?? 8B ?? ?? 50 E8 ?? ?? ?? ?? 83 ?? ?? 89 ?? ?? ?? ?? ?? 33 ?? 74 ?? EB ?? 6A ?? 8D ?? ?? ?? ?? ?? 52 8B ?? ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? 83 ?? ?? 8D ?? ?? ?? ?? ?? 51 8D ?? ?? ?? ?? ?? 52 8D ?? ?? ?? ?? ?? 50 8D ?? ?? ?? ?? ?? 51 8D ?? ?? ?? ?? ?? 52 E8 ?? ?? ?? ?? 83 ?? ?? 33 ?? 74 ?? EB ?? 8D ?? ?? ?? ?? ?? 51 6A ?? 6A }
		// Relevance: 15.903  API Chain: GetCurrentProcessId,OpenEventA,CloseHandle,GetLastError,OpenProcess,EqualSid,CloseHandle,Sleep,
		$code6 = { 55 8B ?? 83 ?? ?? 53 33 ?? 89 ?? ?? 89 ?? ?? 39 ?? ?? ?? ?? ?? 74 ?? 33 ?? E9 ?? ?? ?? ?? 56 8B ?? ?? FF ?? ?? ?? ?? ?? 39 ?? ?? 0F 84 ?? ?? ?? ?? 57 33 ?? 39 ?? ?? ?? ?? ?? 76 ?? A1 ?? ?? ?? ?? FF ?? ?? 8D ?? ?? 50 E8 ?? ?? ?? ?? 59 59 85 ?? 0F 85 ?? ?? ?? ?? 47 3B ?? ?? ?? ?? ?? 72 ?? FF ?? ?? 8D ?? ?? 6A ?? 57 E8 ?? ?? ?? ?? 59 59 50 8D ?? ?? 50 E8 ?? ?? ?? ?? 83 ?? ?? 8D ?? ?? 50 53 6A ?? FF ?? ?? ?? ?? ?? 3B ?? 74 ?? 50 FF ?? ?? ?? ?? ?? E9 ?? ?? ?? ?? FF ?? ?? ?? ?? ?? 83 ?? ?? 0F 85 ?? ?? ?? ?? FF ?? ?? ?? ?? ?? 57 E8 ?? ?? ?? ?? 59 59 85 ?? 74 ?? 6A ?? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 59 }
		// Relevance: 15.826  API Chain: OpenSCManagerA,OpenServiceA,CloseServiceHandle,CreateServiceA,CloseServiceHandle,CloseServiceHandle,
		$code7 = { 55 8B ?? 81 ?? ?? ?? ?? ?? 53 56 33 ?? 68 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 53 50 88 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 53 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 50 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? 6A ?? 53 53 FF ?? ?? ?? ?? ?? 8B ?? 3B ?? 74 ?? 57 8D ?? ?? 68 ?? ?? ?? ?? 50 E8 ?? ?? ?? ?? 59 59 6A ?? 8D ?? ?? 50 56 FF ?? ?? ?? ?? ?? 8B ?? 3B ?? 74 ?? 57 FF ?? ?? ?? ?? ?? EB ?? 53 53 68 ?? ?? ?? ?? 53 53 8D ?? ?? ?? ?? ?? 50 53 6A ?? 6A ?? 68 ?? ?? ?? ?? FF ?? ?? ?? ?? ?? 8D ?? ?? 50 A1 ?? ?? ?? ?? 03 ?? 50 FF ?? ?? ?? ?? ?? 8B ?? 3B ?? 74 ?? 57 FF ?? ?? ?? ?? ?? 56 FF  }
		// Relevance: 14.197  API Chain: RegOpenKeyExA,RegQueryInfoKeyA,SetLastError,RegEnumValueA,lstrlenA,lstrlenA,RegCloseKey,
		$code8 = { 55 8B ?? 81 ?? ?? ?? ?? ?? 53 57 33 ?? 68 ?? ?? ?? ?? 8D ?? ?? ?? ?? ?? 53 50 C7 ?? ?? ?? ?? ?? ?? 89 ?? ?? 88 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 6A ?? 8D ?? ?? ?? ?? ?? 53 BF ?? ?? ?? ?? 50 C7 ?? ?? ?? ?? ?? ?? 89 ?? ?? 88 ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 68 ?? ?? ?? ?? 89 ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? 89 ?? ?? 3B ?? 75 ?? 83 ?? ?? E9 ?? ?? ?? ?? 56 BE ?? ?? ?? ?? 56 E8 ?? ?? ?? ?? 59 89 ?? ?? 3B ?? 74 ?? 56 E8 ?? ?? ?? ?? 59 89 ?? ?? 3B ?? 74 ?? 56 E8 ?? ?? ?? ?? 59 89 ?? ?? 3B ?? 75 ?? 83 ?? ?? E9 ?? ?? ?? ?? 6A ?? 8D ?? ?? ?? ?? ?? 53 50 E8 ?? ?? ?? ?? 53 68 ?? ?? ?? ?? FF ?? ?? BE ?? ?? ?? ?? 56 }
		// Relevance: 14.032  API Chain: lstrlenA,lstrlenA,lstrlenA,lstrcmpA,lstrcmpA,lstrlenA,lstrcpyA,lstrlenA,lstrlenA,lstrcpyA,lstrcpyA,
		$code9 = { 55 8B ?? 83 ?? ?? C7 ?? ?? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? 83 ?? ?? ?? 75 ?? 33 ?? 74 ?? EB ?? 83 ?? ?? E9 ?? ?? ?? ?? 83 ?? ?? ?? 75 ?? 33 ?? 74 ?? EB ?? B8 ?? ?? ?? ?? E9 ?? ?? ?? ?? 8B ?? ?? 52 FF ?? ?? ?? ?? ?? 3D ?? ?? ?? ?? 7E ?? 8B ?? ?? 50 FF ?? ?? ?? ?? ?? D1 ?? 89 ?? ?? EB ?? C7 ?? ?? ?? ?? ?? ?? 83 ?? ?? ?? 76 ?? 8B ?? ?? 51 E8 ?? ?? ?? ?? 83 ?? ?? 89 ?? ?? 83 ?? ?? ?? 75 ?? 33 ?? 74 ?? EB ?? B8 ?? ?? ?? ?? E9 ?? ?? ?? ?? 8B ?? ?? 50 8B ?? ?? 51 E8 ?? ?? ?? ?? 83 ?? ?? 33 ?? 74 ?? EB ?? 8B ?? ?? 83 ?? ?? 75 ?? E8 ?? ?? ?? ?? 85 ?? 7D ?? 83 }
	condition:
		all of them
}
