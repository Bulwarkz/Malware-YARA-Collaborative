import "pe"

rule sampe_jfwueoo_exe_2464_exe_2544_dr_1 {
	meta:
		description = "simple rule for file"
		author = "Bulwarkz 1.0.0"
		yaraversion = ">= 3.2.0"
		tag = "Bulwarkz"
		source = "jfwueoo.exe.2464.exe.2544.dr"
		joesandboxid = "242621"
		detection = "malicious"
		ruletype = "dropped"
		superrule = "no"
		falsepositiverate = "unknown"
		md5 = "56b52a9dd6301f036939ecb780b50f1d"
		sha1 = "7fab62ba86cdc8cf9d45b0557918db8eae5e21ce"
		sha256 = "565245897fb9c46d3daf9e1b9382d77c24ce4c544578814d93976f95212bb99a"
		date = "23/03/2017"
	strings:
		// Relevance: 6.0 Appears at: 38c
		$s0 = "RECOVER_USER_FILES" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 18ad
		$s1 = "%I64x%W%W%I64x%I64x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 556
		$s2 = "%I64d%x%x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 18fb
		$s3 = "%I64x%x%x%I64x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: d7d
		$s4 = "%x%x%I64x%I64x%I64x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 18ec
		$s5 = "%I64x%W%x%I64x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: cf0
		$s6 = "%x%x%x%x%x%I64x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 185d
		$s7 = "%W%I64x%x%x%I64x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 1880
		$s8 = "%W%x%x%I64x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: e6d
		$s9 = "%I64x%x%x%x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 18dd
		$s10 = "%I64x%W%W%I64x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 560
		$s11 = "%x%I64x%x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: dbc
		$s12 = "%W%d%I64d" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 186a
		$s13 = "%W%I64x%I64x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 1b3e
		$s14 = "autoconv.pdb" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 179a
		$s15 = "%I64x%W%d" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: d4d
		$s16 = "%d%W%d" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: 1704
		$s17 = "FILE%04d.CHK" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: e97
		$s18 = "%x%x%I64x%I64x" fullword nocase wide ascii
		// Relevance: 3.0 Appears at: f04
		$s19 = "%I64x%I64x%I64x%x" fullword nocase wide ascii
		// Opcode sequence from the PE entrypoint
		$entrypointOpCode = { C2 ?? ?? 8B ?? 8B ?? 85 ?? 75 ?? 57 FF ?? ?? }
	condition:
		all of them
		// PE Section check
		and pe.sections[0].name contains ".text"
		and pe.sections[1].name contains ".data"
		and pe.sections[2].name contains ".rsrc"
		and pe.sections[3].name contains ".reloc"
		// PE Image characteristic check
		and pe.characteristics & pe.EXECUTABLE_IMAGE
		// PE subsystem check
		and pe.subsystem & pe.SUBSYSTEM_NATIVE
}
rule sampe_oduodorg_exe_2228_dr_2 {
	meta:
		description = "simple rule for file"
		author = "Bulwarkz  1.0.0"
		yaraversion = ">= 3.2.0"
		tag = "Bulwarkz"
		source = "oduodorg.exe.2228.dr"
		joesandboxid = "242621"
		detection = "malicious"
		ruletype = "dropped"
		superrule = "no"
		falsepositiverate = "unknown"
		md5 = "8eedfeedacf985bd269e353fe962ea17"
		sha1 = "059e3b7dd98f5c411cc407d2973d5c9c32aafb7f"
		sha256 = "6aad36b27c188e73090f3b79352750489a1dce20f5396e63b2af3e998eba0f0a"
		date = "23/03/2017"
	strings:
		// Relevance: 3.0 Appears at: 5d
		$s0 = "`.data" fullword nocase wide ascii
		// Relevance: 0.0 Appears at: 7a78
		$s1 = "D=@$Cp" fullword nocase wide ascii
		// Relevance: 0.0 Appears at: e1
		$s2 = "4eds2e" fullword nocase wide ascii
		// Relevance: 0.0 Appears at: 9252
		$s3 = "9@=87~" fullword nocase wide ascii
		// Relevance: 0.0 Appears at: eb
		$s4 = "0x3EED" fullword nocase wide ascii
		// Relevance: 0.0 Appears at: 1f21
		$s5 = "CKI`` " fullword nocase wide ascii
		// Relevance: 0.0 Appears at: cbfa
		$s6 = "c2[?d@=?d@=?d" fullword nocase wide ascii
		// Relevance: 0.0 Appears at: 9852
		$s7 = "h1`4j==" fullword nocase wide ascii
		// Relevance: 0.0 Appears at: 5094
		$s8 = "0d3>;e;=" fullword nocase wide ascii
		// Relevance: 0.0 Appears at: bf71
		$s9 = "VG?\"E,(%" fullword nocase wide ascii
		// Relevance: 0.0 Appears at: d8
		$s10 = "qla54d" fullword nocase wide ascii
		// Opcode sequence from the PE entrypoint
		$entrypointOpCode = { 55 89 ?? 83 ?? ?? 8D ?? ?? A3 ?? ?? ?? ?? 31 }
	condition:
		all of them
		// PE Section check
		and pe.sections[0].name contains ".text"
		and pe.sections[1].name contains ".data"
		// PE Image characteristic check
		and pe.characteristics & pe.EXECUTABLE_IMAGE
		and pe.characteristics & pe.RELOCS_STRIPPED
		// PE subsystem check
		and pe.subsystem & pe.SUBSYSTEM_WINDOWS_CUI
}
